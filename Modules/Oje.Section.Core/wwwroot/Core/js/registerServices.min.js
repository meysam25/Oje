function subscribeUser(){Notification.requestPermission(n=>{n==="granted"});"serviceWorker"in navigator&&(navigator.serviceWorker.ready.then(function(n){n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:"BA6du-qsB9r3a1IyRHIULY1r6MO57R3dpU9eaXpkLj8JUVaUqTN3wC7DgHfYCKgfM2FzW5wHiNl1cyME9bvmfV4"}).then(function(n){console.log("Endpoint URL: ",n.endpoint)}).catch(function(n){Notification.permission==="denied"?console.warn("Permission for notifications was denied"):console.error("Unable to subscribe to push",n)})}),window.addEventListener("load",function(){navigator.serviceWorker.register("/serviceWorker.js?v=9").then(n=>{n.pushManager.getSubscription().then(function(n){if(n===null)console.log("Not subscribed to push service!");else{var t=new FormData;t.append("auth",arrayBufferToBase64(n.getKey("auth")));t.append("p256DH",arrayBufferToBase64(n.getKey("p256dh")));t.append("endpoint",n.endpoint);postForm("/Home/PushNotificationSubscribe",t)}})}).catch(n=>console.log("service worker not registered",n))}))}function arrayBufferToBase64(n){for(var i="",r=new Uint8Array(n),u=r.byteLength,t=0;t<u;t++)i+=String.fromCharCode(r[t]);return window.btoa(i)}subscribeUser();